### 基础
#### 并发编程模型分类
>并发编程中，需处理两关键点：①线程间如何通信；②线程间如何同步。  
通信指：线程间以何种机制交换信息。  
命令式编程，线程间通信机制：①内存共享；②消息传递。

>共享内存并发模型：线程间共享程序公共状态(通过它隐式通信)；  
消息传递并发模型：线程间无公共状态(需明确发送消息显示通信)。

>同步：程序用于控制不同线程间操作发生相对顺序的机制。 
>>在共享内存并发模型，同步是显示的(需指定某个方法或代码块进行线程间互斥)；  
在消息传递并发模型，同步是隐式的（消息发送在接收前）。
>- java的并发采用共享内存模型，java线程间的通信为隐式。

#### java内存模型的抽象
>堆内存（共享变量）：实例域、静态域和数组元素，在线程间共享。  
局部变量、方法定义参数、异常处理器参数不会在线程间共享（不会有内存可见性问题）  

>java线程间通信由java内存模型(JMM)控制，它决定了一个线程对共享变量的写入何时对另一个线程可见。  
>>线程间共享变量存储在主内存中，每个线程都有私有的本地内存（读/写共享变量的副本，抽象概念不真实存在）。JMM涵盖了缓存、写缓冲区、寄存器及其他的硬件和编译器优化。

- 图1
>线程A与线程B通信，步骤：  
①线程A把本地内存A中更新过的共享变量刷新到主内存；  
②线程B到主内存读取线程A已更新过的共享变量。

- 图2
>假若本地内存A、B都有主内存的共享变量x的副本(默认都为0)。  
①线程A更新x值为1，临时存放本地内存A；  
②线程A和线程B需通信时，线程A会把修改后的x值刷新到内存，随后线程B到主内存读取线程A更新后的值。  
两步骤是线程A向线程B发送消息，通信过程经过主内存。  
JMM通过控制主内存与每个线程本地内存间的交互，来提供内存可见性保证。

